"use strict";(self.webpackChunkangular_messenger=self.webpackChunkangular_messenger||[]).push([[838],{5838:(H,_,l)=>{l.r(_),l.d(_,{AuthModule:()=>K});var g=l(6814),m=l(4087),o=l(6223),c=function(e){return e.InvalidFormDataException="InvalidFormDataException",e.NotFoundException="NotFoundException",e}(c||{}),f=l(8645),p=l(9773),t=l(5879),v=l(6238),b=l(9862);let w=(()=>{class e{constructor(n){this.http=n,this.apiUrl=v.AW}loginUser(n){const{email:i,password:r}=n;return this.http.post(this.apiUrl,{email:i,password:r})}static#t=this.\u0275fac=function(i){return new(i||e)(t.LFG(b.eN))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac})}return e})();var C=l(754),U=l(4567),T=l(7466);function F(e,s){1&e&&(t.TgZ(0,"small"),t._uU(1," Please enter a login email "),t.qZA())}function x(e,s){1&e&&(t.TgZ(0,"small"),t._uU(1," The login email is invalid "),t.qZA())}function E(e,s){if(1&e&&(t.TgZ(0,"div",14),t.YNc(1,F,2,0,"small",15),t.YNc(2,x,2,0,"small",15),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngIf",n.getError("email","required")),t.xp6(1),t.Q6J("ngIf",n.getError("email","email"))}}function y(e,s){1&e&&(t.TgZ(0,"small"),t._uU(1," Please enter a password. "),t._UZ(2,"br"),t.qZA())}function S(e,s){if(1&e&&(t.TgZ(0,"small"),t._uU(1," Your password isn't strong enough. "),t._UZ(2,"br"),t._uU(3),t.qZA()),2&e){const n=t.oxw(2);t.xp6(3),t.hij(" Recommendations: ",null==n.password||null==n.password.errors?null:n.password.errors.message," ")}}function I(e,s){if(1&e&&(t.TgZ(0,"div",14),t.YNc(1,y,3,0,"small",15),t.YNc(2,S,4,1,"small",15),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngIf",n.getError("password","required")),t.xp6(1),t.Q6J("ngIf",n.getError("password","strongPassword"))}}const Z=function(e){return{invalid:e}};let A=(()=>{class e{constructor(n,i,r,a,h){this.fb=n,this.loginService=i,this.toastService=r,this.authService=a,this.router=h,this.isSubmitting=!1,this.hasUserChangedInput=!1,this.ngUnsubscribe=new f.x}ngOnInit(){this.initForm(),this.subscribeToFormChanges()}initForm(){this.loginForm=this.fb.group({email:["",[o.kI.required,o.kI.email]],password:["",[o.kI.required]]})}subscribeToFormChanges(){this.formChangesSubscription=this.loginForm.valueChanges.subscribe(()=>{this.hasUserChangedInput&&(this.hasUserChangedInput=!1)})}get email(){return this.loginForm.get("email")}get password(){return this.loginForm.get("password")}getError(n,i){return this.loginForm.get(n)?.hasError(i)}onSubmit(){if(this.loginForm.invalid||this.isSubmitting)return;const n=this.loginForm.value;this.isSubmitting=!0,this.hasUserChangedInput=!0,this.loginService.loginUser(n).pipe((0,p.R)(this.ngUnsubscribe)).subscribe({next:i=>this.handleLoginSuccess(i),error:i=>this.handleLoginError(i)})}handleLoginSuccess(n){this.isSubmitting=!1,this.authService.saveCredentialsToLocalStorage(n,this.loginForm.value.email),this.showToastAndRedirect()}showToastAndRedirect(){this.toastService.showToast("Login successful!",!1),this.router.navigateByUrl("/")}handleLoginError(n){if(this.isSubmitting=!1,400===n.status)switch(n.error.type){case c.InvalidFormDataException:this.handleInvalidFormDataException(n.error.message);break;case c.NotFoundException:this.handleNotFoundException(n.error.message);break;default:this.handleOtherErrors()}else this.handleOtherErrors()}handleInvalidFormDataException(n){this.toastService.showToast(n,!0)}handleNotFoundException(n){this.toastService.showToast(n,!0)}handleOtherErrors(){this.toastService.showToast("Login error",!0)}ngOnDestroy(){this.formChangesSubscription&&this.formChangesSubscription.unsubscribe(),this.ngUnsubscribe.next(),this.ngUnsubscribe.complete()}static#t=this.\u0275fac=function(i){return new(i||e)(t.Y36(o.qu),t.Y36(w),t.Y36(C.k),t.Y36(U.e),t.Y36(m.F0))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-login-page"]],decls:22,vars:11,consts:[[1,"login",3,"formGroup","ngSubmit"],[1,"login__title"],["for","email"],[1,"login__control",3,"ngClass"],["id","email","type","email","formControlName","email","autocomplete","email"],["class","validation",4,"ngIf"],["for","password"],["id","password","type","password","formControlName","password","autocomplete","current-password",3,"input"],[1,"login__link"],["routerLink","/auth/signup"],[1,"login__button-submit"],["type","submit",3,"disabled","buttonText"],[1,"login__glory"],["src","../../../../assets/icons/auth/glory.png","alt","For the glory of mankind"],[1,"validation"],[4,"ngIf"]],template:function(i,r){1&i&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return r.onSubmit()}),t.TgZ(1,"h2",1),t._uU(2,"Sign In"),t.qZA(),t.TgZ(3,"label",2),t._uU(4,"email"),t.qZA(),t.TgZ(5,"div",3),t._UZ(6,"input",4),t.qZA(),t.YNc(7,E,3,2,"div",5),t.TgZ(8,"label",6),t._uU(9," password "),t.qZA(),t.TgZ(10,"div",3)(11,"input",7),t.NdJ("input",function(){return null==r.password?null:r.password.markAsTouched()}),t.qZA()(),t.YNc(12,I,3,2,"div",5),t.TgZ(13,"div",8)(14,"span"),t._uU(15,"Don't have an account? "),t.qZA(),t.TgZ(16,"a",9),t._uU(17," Sign Up "),t.qZA()(),t.TgZ(18,"div",10),t._UZ(19,"app-cyber-button",11),t.qZA()(),t.TgZ(20,"div",12),t._UZ(21,"img",13),t.qZA()),2&i&&(t.Q6J("formGroup",r.loginForm),t.xp6(5),t.Q6J("ngClass",t.VKq(7,Z,(null==r.email?null:r.email.touched)&&(null==r.email?null:r.email.invalid))),t.xp6(2),t.Q6J("ngIf",(null==r.email?null:r.email.touched)&&(null==r.email?null:r.email.invalid)),t.xp6(3),t.Q6J("ngClass",t.VKq(9,Z,(null==r.password?null:r.password.touched)&&(null==r.password?null:r.password.invalid))),t.xp6(2),t.Q6J("ngIf",(null==r.password?null:r.password.touched)&&(null==r.password?null:r.password.invalid)),t.xp6(7),t.Q6J("disabled",r.loginForm.invalid||r.isSubmitting||r.hasUserChangedInput)("buttonText",r.isSubmitting?"Logging in...":"Login"))},dependencies:[g.mk,g.O5,m.rH,T.w,o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u],styles:['.login[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:700px;margin:0 auto;padding:2rem 1.5rem;background:var(--color-alert-trans);color:var(--color-high);border-radius:10px;clip-path:polygon(0 0,calc(100% - 95px) 0,100% 95px,100% 100%,70px 100%,0 calc(100% - 70px))}.login__title[_ngcontent-%COMP%]{margin-bottom:1rem}.login__control[_ngcontent-%COMP%]{position:relative;color:var(--color-low);border-left:15px solid var(--font-dark)}.login__control[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:10px;width:5px;height:100%;background-color:var(--font-dark)}.login__control[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:3rem;border-color:transparent;background-color:var(--color-high-trans);outline:none;padding:.8rem .8rem .8rem 2rem}.login__link[_ngcontent-%COMP%]{padding:1rem 0;font-size:.8rem}.login__link[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--color-alert)}.login__button-submit[_ngcontent-%COMP%]{display:flex;padding-top:1rem}.login__glory[_ngcontent-%COMP%]{position:absolute;bottom:3rem;right:4rem}.validation[_ngcontent-%COMP%]{color:var(--danger-color)}.invalid[_ngcontent-%COMP%]{color:var(--danger-color);border-left:15px solid var(--danger-color)}.invalid[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:1px solid var(--danger-color);outline-color:var(--danger-color)}.invalid[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:10px;width:5px;height:100%;background-color:var(--danger-color)}label[_ngcontent-%COMP%]{display:block;padding-left:.5rem;margin-bottom:.5rem;margin-top:.5rem}']})}return e})();var u=function(e){return e.InvalidFormData="InvalidFormDataException",e.UnknownFormat="Invalid post data",e.MissingParameters='Parameters "email", "name", and "password" are required',e.UserExists="PrimaryDuplicationException",e}(u||{});let P=(()=>{class e{constructor(n){this.http=n,this.apiUrl=v.WC}registerUser(n){const{name:i,email:r,password:a}=n;return this.http.post(this.apiUrl,{name:i,email:r,password:a})}static#t=this.\u0275fac=function(i){return new(i||e)(t.LFG(b.eN))};static#e=this.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac})}return e})();function O(e,s){1&e&&(t.TgZ(0,"small"),t._uU(1," Please enter a name "),t.qZA())}function q(e,s){1&e&&(t.TgZ(0,"small"),t._uU(1," The name exceeds 40 characters "),t.qZA())}function J(e,s){1&e&&(t.TgZ(0,"small"),t._uU(1," Allowed only letters or spaces "),t.qZA())}function M(e,s){if(1&e&&(t.TgZ(0,"div",14),t.YNc(1,O,2,0,"small",15),t.YNc(2,q,2,0,"small",15),t.YNc(3,J,2,0,"small",15),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngIf",n.getError("name","required")),t.xp6(1),t.Q6J("ngIf",n.getError("name","maxlength")),t.xp6(1),t.Q6J("ngIf",n.getError("name","pattern"))}}function N(e,s){1&e&&(t.TgZ(0,"small"),t._uU(1,"Please enter a register email"),t.qZA())}function Y(e,s){1&e&&(t.TgZ(0,"small"),t._uU(1,"The register email is invalid"),t.qZA())}function R(e,s){1&e&&(t.TgZ(0,"small"),t._uU(1,"Email address is already taken"),t.qZA())}function D(e,s){if(1&e&&(t.TgZ(0,"div",14),t.YNc(1,N,2,0,"small",15),t.YNc(2,Y,2,0,"small",15),t.YNc(3,R,2,0,"small",15),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngIf",n.getError("email","required")),t.xp6(1),t.Q6J("ngIf",n.getError("email","email")),t.xp6(1),t.Q6J("ngIf",n.isPrimaryDuplicationError||n.getError("email","taken"))}}function Q(e,s){1&e&&(t.TgZ(0,"small"),t._uU(1,"Please enter a password. "),t._UZ(2,"br"),t.qZA())}function L(e,s){1&e&&(t.TgZ(0,"small"),t._uU(1,"At least 8 characters. "),t._UZ(2,"br"),t.qZA())}function j(e,s){if(1&e&&(t.TgZ(0,"small"),t._uU(1," Your password isn't strong enough. "),t._UZ(2,"br"),t._uU(3),t.qZA()),2&e){const n=t.oxw(2);t.xp6(3),t.hij(" Recommendations: ",null==n.password||null==n.password.errors?null:n.password.errors.message," ")}}function z(e,s){if(1&e&&(t.TgZ(0,"div",14),t.YNc(1,Q,3,0,"small",15),t.YNc(2,L,3,0,"small",15),t.YNc(3,j,4,1,"small",15),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.Q6J("ngIf",n.getError("password","required")),t.xp6(1),t.Q6J("ngIf",n.getError("password","minlength")),t.xp6(1),t.Q6J("ngIf",n.getError("password","strongPassword"))}}const d=function(e){return{invalid:e}},G=/^[\p{L} ]+$/u,V=[{path:"",redirectTo:"signin",pathMatch:"full"},{path:"signin",component:A},{path:"signup",component:(()=>{class e{constructor(n,i,r,a){this.fb=n,this.registerService=i,this.router=r,this.toastService=a,this.isSubmitting=!1,this.isHttpError=!1,this.isPrimaryDuplicationError=!1,this.usedEmails=[],this.emailUnsubscribe$=new f.x}ngOnInit(){this.initForm(),this.subscribeToFormChanges()}initForm(){this.registerForm=this.fb.group({name:["",[o.kI.required,o.kI.maxLength(40),o.kI.pattern(G)]],email:["",[o.kI.required,o.kI.email]],password:["",[o.kI.required,o.kI.minLength(8),e=>{const{value:s}=e,n=/[A-Z]/.test(s),i=/\d/.test(s),r=/[!@#?]/.test(s);if(n&&i&&r)return null;let a="";return n||(a+="at least one capital letter, "),i||(a+="at least one digit, "),r||(a+="at least one special character, e.g., ! @ # ? "),{strongPassword:!0,message:a}}]]})}subscribeToFormChanges(){this.registerForm.get("email")?.valueChanges.pipe((0,p.R)(this.emailUnsubscribe$)).subscribe(n=>{this.checkForDuplication(n)})}get name(){return this.registerForm.get("name")}get email(){return this.registerForm.get("email")}get password(){return this.registerForm.get("password")}getError(n,i){return this.registerForm.get(n)?.hasError(i)}onSubmit(){if(this.registerForm.invalid||this.isSubmitting)return;const n=this.registerForm.value;this.isSubmitting=!0,this.registerService.registerUser(n).pipe((0,p.R)(this.emailUnsubscribe$)).subscribe({next:()=>this.handleRegistrationSuccess(),error:i=>this.handleRegistrationError(i)})}handleRegistrationSuccess(){this.isSubmitting=!1,this.toastService.showToast("Registration successful!",!1),this.usedEmails=[],this.router.navigate(["auth","signin"])}handleRegistrationError(n){if(this.isSubmitting=!1,400===n.status)switch(n.error.type){case u.InvalidFormData||u.UnknownFormat||u.MissingParameters:this.handleInvalidFormDataException(n.error.message);break;case u.UserExists:this.handlePrimaryDuplicationException(n.error.message);break;default:this.handleOtherErrors()}else this.isHttpError=!0,this.handleOtherErrors()}handleInvalidFormDataException(n){this.toastService.showToast(n,!0)}handlePrimaryDuplicationException(n){this.toastService.showToast(n,!0),this.isPrimaryDuplicationError=!0,this.registerForm.get("email")?.setErrors({taken:!0}),this.usedEmails.push(this.registerForm.value.email)}handleOtherErrors(){this.toastService.showToast("Registration error",!0)}checkForDuplication(n){this.isPrimaryDuplicationError=this.usedEmails.includes(n),this.isPrimaryDuplicationError&&this.registerForm.get("email")?.setErrors({taken:!0})}ngOnDestroy(){this.emailUnsubscribe$.next(),this.emailUnsubscribe$.complete()}static#t=this.\u0275fac=function(i){return new(i||e)(t.Y36(o.qu),t.Y36(P),t.Y36(m.F0),t.Y36(C.k))};static#e=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-register-page"]],decls:22,vars:15,consts:[[1,"register",3,"formGroup","ngSubmit"],[1,"register__title"],["for","name"],[1,"register__control",3,"ngClass"],["id","name","type","text","formControlName","name","autocomplete","name"],["class","validation",4,"ngIf"],["for","email"],["id","email","type","email","formControlName","email","autocomplete","email"],["for","password"],["id","password","type","password","formControlName","password","autocomplete","current-password",3,"input"],[1,"register__button-submit"],["type","submit",3,"disabled","buttonText"],[1,"register__glory"],["src","../../../../assets/icons/auth/glory.png","alt","For the glory of mankind"],[1,"validation"],[4,"ngIf"]],template:function(i,r){1&i&&(t.TgZ(0,"form",0),t.NdJ("ngSubmit",function(){return r.onSubmit()}),t.TgZ(1,"h2",1),t._uU(2,"Sign Up"),t.qZA(),t.TgZ(3,"label",2),t._uU(4,"name"),t.qZA(),t.TgZ(5,"div",3),t._UZ(6,"input",4),t.qZA(),t.YNc(7,M,4,3,"div",5),t.TgZ(8,"label",6),t._uU(9,"email"),t.qZA(),t.TgZ(10,"div",3),t._UZ(11,"input",7),t.qZA(),t.YNc(12,D,4,3,"div",5),t.TgZ(13,"label",8),t._uU(14," password "),t.qZA(),t.TgZ(15,"div",3)(16,"input",9),t.NdJ("input",function(){return null==r.password?null:r.password.markAsTouched()}),t.qZA()(),t.YNc(17,z,4,3,"div",5),t.TgZ(18,"div",10),t._UZ(19,"app-cyber-button",11),t.qZA()(),t.TgZ(20,"div",12),t._UZ(21,"img",13),t.qZA()),2&i&&(t.Q6J("formGroup",r.registerForm),t.xp6(5),t.Q6J("ngClass",t.VKq(9,d,(null==r.name?null:r.name.touched)&&(null==r.name?null:r.name.invalid))),t.xp6(2),t.Q6J("ngIf",(null==r.name?null:r.name.touched)&&(null==r.name?null:r.name.invalid)),t.xp6(3),t.Q6J("ngClass",t.VKq(11,d,(null==r.email?null:r.email.touched)&&(null==r.email?null:r.email.invalid))),t.xp6(2),t.Q6J("ngIf",(null==r.email?null:r.email.touched)&&(null==r.email?null:r.email.invalid)),t.xp6(3),t.Q6J("ngClass",t.VKq(13,d,(null==r.password?null:r.password.touched)&&(null==r.password?null:r.password.invalid))),t.xp6(2),t.Q6J("ngIf",(null==r.password?null:r.password.touched)&&(null==r.password?null:r.password.invalid)),t.xp6(2),t.Q6J("disabled",r.registerForm.invalid||r.isSubmitting||r.isPrimaryDuplicationError||r.isHttpError)("buttonText",r.isSubmitting?"Registering...":"Register"))},dependencies:[g.mk,g.O5,T.w,o._Y,o.Fj,o.JJ,o.JL,o.sg,o.u],styles:['.register[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:700px;margin:0 auto;padding:2rem 1.5rem;background:var(--color-alert-trans);border-radius:10px;color:var(--color-high);clip-path:polygon(0 0,calc(100% - 115px) 0,100% 115px,100% 100%,60px 100%,0 calc(100% - 60px));-webkit-mask:var(--mask);mask:var(--mask)}.register__title[_ngcontent-%COMP%]{margin-bottom:1rem}.register__control[_ngcontent-%COMP%]{position:relative;color:var(--color-low);border-left:15px solid var(--font-dark)}.register__control[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:10px;width:5px;height:100%;background-color:var(--font-dark)}.register__control[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;height:3rem;border-color:transparent;background-color:var(--color-high-trans);outline:none;padding:.8rem .8rem .8rem 2rem}.register__button-submit[_ngcontent-%COMP%]{display:flex;padding-top:1rem}.register__glory[_ngcontent-%COMP%]{position:absolute;bottom:3rem;right:4rem}.validation[_ngcontent-%COMP%]{color:var(--danger-color)}.invalid[_ngcontent-%COMP%]{color:var(--danger-color);border-left:15px solid var(--danger-color)}.invalid[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:1px solid var(--danger-color);outline-color:var(--danger-color)}.invalid[_ngcontent-%COMP%]:before{content:"";position:absolute;top:0;left:10px;width:5px;height:100%;background-color:var(--danger-color)}label[_ngcontent-%COMP%]{display:block;padding-left:.5rem;margin-bottom:.5rem;margin-top:.5rem}']})}return e})()}];let $=(()=>{class e{static#t=this.\u0275fac=function(i){return new(i||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({imports:[m.Bz.forChild(V),m.Bz]})}return e})();var B=l(153);let K=(()=>{class e{static#t=this.\u0275fac=function(i){return new(i||e)};static#e=this.\u0275mod=t.oAB({type:e});static#n=this.\u0275inj=t.cJS({providers:[P,w],imports:[g.ez,$,B.m]})}return e})()}}]);