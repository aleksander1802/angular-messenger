<div class="group">
    <h2>Groups</h2>

    <div class="group__buttons">
        <div class="group__buttons__create">
            <app-cyber-button
                [buttonText]="'Create'"
                (click)="onCreateClick($event)"
            ></app-cyber-button>
        </div>
        <div class="group__buttons__refresh">
            <div>timer</div>
            <mat-icon>refresh</mat-icon>
        </div>
    </div>

    <div
        class="group__list"
        *ngIf="groupItems$ | async as groupData; else loading"
    >
        <ul class="group__list__items">
            <li *ngFor="let item of groupData" class="group__list__item">
                <a href="#" class="group__list__item__link">{{
                    item.name.S
                }}</a>
                <mat-icon
                    (click)="openDeleteModal($event)"
                    *ngIf="item.id.S === currentLocalStorageUID"
                    class="group__list__item__delete"
                    >delete</mat-icon
                >
            </li>
        </ul>
    </div>

    <div *ngIf="showDeleteModal">
        <div class="group__modal">
            <h2 class="group__modal__title">
                Are you sure you want to delete this group?
            </h2>
            <div class="group__modal__buttons">
                <app-cyber-button
                    (click)="confirmDelete($event)"
                    [buttonText]="'Delete'"
                ></app-cyber-button>
                <app-cyber-button
                    (click)="cancelDelete($event)"
                    [buttonText]="'Cancel'"
                ></app-cyber-button>
            </div>
        </div>
    </div>

    <div *ngIf="isCreateMode">
        <form class="group__form" *ngIf="groupForm" [formGroup]="groupForm">
            <h2 class="group__form__title">Create group</h2>
            <div
                class="group__form__control"
                [ngClass]="{ invalid: name?.touched && name?.invalid }"
            >
                <label for="name">name</label>
                <input
                    id="name"
                    type="name"
                    formControlName="name"
                    autocomplete="name"
                />
                <div class="validation" *ngIf="name?.touched && name?.invalid">
                    <small *ngIf="getError('name', 'required')">
                        Please enter a name
                    </small>
                    <small *ngIf="getError('name', 'maxlength')">
                        The name exceeds 30 characters
                    </small>
                    <small *ngIf="getError('name', 'pattern')">
                        The name must contain only letters, numbers, or spaces
                    </small>
                </div>
            </div>

            <div class="group__form__buttons">
                <app-cyber-button
                    [disabled]="groupForm.invalid"
                    type="button"
                    (click)="onCreateGroupSubmit($event)"
                    [buttonText]="'Create'"
                ></app-cyber-button>

                <app-cyber-button
                    type="button"
                    (click)="onCancelCreate($event)"
                    [buttonText]="'Cancel'"
                ></app-cyber-button>
            </div>
        </form>
    </div>

    <ng-template #loading>
        <p>Loading...</p>
    </ng-template>
</div>
