<div class="profile" *ngIf="profile$ | async as profile; else loading">
    <h2 class="profile__title">User Profile</h2>
    <div class="profile__form">
        <ul class="profile__list">
            <li><strong>User ID:</strong> {{ profile.uid.S }}</li>
            <li><strong>Email:</strong> {{ profile.email.S }}</li>
            <li>
                <strong>Creation Time:</strong>
                {{ profile.createdAt.S | date : "longDate" }}
            </li>
            <li>
                <strong>User Name:</strong>
                <ng-container *ngIf="!isEditMode; else editModeComponent">
                    {{ profile.name.S }}
                </ng-container>
            </li>
        </ul>
    </div>

    <div class="profile__edit__button" *ngIf="!isEditMode">
        <app-cyber-button
            [disabled]="(isProfileLoading$ | async) || false"
            (click)="onEditClick()"
            [buttonText]="'Edit'"
        ></app-cyber-button>
    </div>

    <ng-template #editModeComponent>
        <form *ngIf="profileForm" [formGroup]="profileForm">
            <div
                class="profile__control"
                [ngClass]="{ invalid: name?.touched && name?.invalid }"
            >
                <input
                    id="name"
                    type="text"
                    formControlName="name"
                    autocomplete="name"
                />
                <div class="validation" *ngIf="name?.touched && name?.invalid">
                    <small *ngIf="getError('name', 'required')">
                        Please enter a name
                    </small>
                    <small *ngIf="getError('name', 'maxlength')">
                        The name exceeds 40 characters
                    </small>
                </div>
            </div>

            <div class="profile__edit__buttons">
                <app-cyber-button
                    [disabled]="profileForm.invalid"
                    (click)="onSaveClick()"
                    [buttonText]="'Save'"
                ></app-cyber-button>

                <app-cyber-button
                    (click)="onCancelClick()"
                    [buttonText]="'Cancel'"
                ></app-cyber-button>
            </div>
        </form>
    </ng-template>
</div>

<ng-template #loading>
    <p>Loading...</p>
</ng-template>

<div class="profile__logout">
    <app-cyber-button
        [buttonText]="'Logout'"
        (click)="onLogout()"
        [disabled]="(isProfileLoading$ | async) || false"
    ></app-cyber-button>
</div>

<div class="profile__prevpage">
    <app-cyber-button
        [buttonText]="'Back'"
        (click)="backToPreviousPage()"
        [disabled]=" (isProfileLoading$ | async) || false"
    ></app-cyber-button>
</div>
